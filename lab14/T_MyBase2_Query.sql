USE T_MyBase2;
GO


DROP FUNCTION COUNT_EQUIPMENT;
GO

CREATE FUNCTION COUNT_EQUIPMENT()
RETURNS int
AS BEGIN
	DECLARE @Count int = (SELECT COUNT(*) FROM Equipment);
	RETURN @Count;
END;
GO

SELECT dbo.COUNT_EQUIPMENT() AS 'Количество оборудования';


DROP FUNCTION COUNT_WORKER;
GO

CREATE FUNCTION COUNT_WORKER()
RETURNS int
AS BEGIN
	DECLARE @Count int = (SELECT COUNT(*) FROM Worker);
	RETURN @Count;
END;
GO

SELECT dbo.COUNT_WORKER() AS 'Количество работников';
GO


DROP FUNCTION GET_ARRIVAL;
GO

CREATE FUNCTION GET_ARRIVAL()
RETURNS TABLE
AS RETURN (
	SELECT
		ID,
		Equipment,
		ArrivalDate
	FROM Arrival
);
GO

SELECT * FROM dbo.GET_ARRIVAL();
GO
